<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Status Metro New — Управление</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />
  <style>
    /* Модальное окно */
    .modal-bg {
      background-color: rgba(0, 0, 0, 0.5);
    }
    .tab-content > div {
      display: none;
    }
    .tab-content > div.active {
      display: block;
    }
    /* Кнопки табов */
    .tab-btn.active {
      border-bottom: 3px solid #4f46e5; /* Indigo-600 */
      font-weight: 600;
      color: #4f46e5;
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
  <!-- Админ кнопка входа -->
  <button
    id="adminOpenBtn"
    title="Вход в админку"
    class="fixed top-4 right-4 z-50 bg-indigo-600 hover:bg-indigo-700 text-white p-3 rounded-full shadow-lg transition"
  >
    <i class="fas fa-cog fa-lg"></i>
  </button>

  <!-- Модальное окно админки -->
  <div
    id="adminModal"
    class="modal-bg fixed inset-0 flex items-center justify-center hidden"
  >
    <div
      class="bg-white rounded-lg shadow-xl w-full max-w-3xl p-6 relative"
      role="dialog"
      aria-modal="true"
      aria-labelledby="adminTitle"
    >
      <button
        id="adminCloseBtn"
        class="absolute top-3 right-3 text-gray-500 hover:text-gray-700"
        title="Закрыть"
      >
        <i class="fas fa-times fa-lg"></i>
      </button>

      <h2
        id="adminTitle"
        class="text-2xl font-bold mb-4 flex items-center gap-2"
      >
        <i class="fas fa-tools text-indigo-600"></i> Панель администратора
      </h2>

      <!-- Ввод кода -->
      <div id="adminLoginSection">
        <p class="mb-2 text-gray-700">
          Введите пароль администратора для доступа к настройкам:
        </p>
        <input
          id="adminCodeInput"
          type="password"
          placeholder="Введите код доступа"
          class="w-full p-2 border rounded mb-4"
          autocomplete="off"
        />
        <button
          id="adminLoginBtn"
          class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded"
        >
          Войти
        </button>
        <p id="loginError" class="text-red-600 mt-2 hidden">Неверный код доступа!</p>
      </div>

      <!-- Основная админка -->
      <div id="adminPanel" class="hidden">
        <!-- Время обновления и комментарий -->
        <div
          id="lastUpdateInfo"
          class="mb-4 bg-indigo-50 border border-indigo-200 text-indigo-700 p-3 rounded"
        >
          <strong>Последнее обновление:</strong> <span id="lastUpdateText">-</span><br />
          <strong>Комментарий:</strong> <span id="adminCommentText">-</span>
        </div>

        <!-- Таб кнопки -->
        <div class="flex gap-4 mb-6 border-b border-gray-300">
          <button
            class="tab-btn py-2 px-4 cursor-pointer active text-indigo-600 border-b-2 border-indigo-600"
            data-tab="mainSettings"
          >
            Основные настройки
          </button>
          <button class="tab-btn py-2 px-4 cursor-pointer" data-tab="onlineStatus">
            Онлайн
          </button>
          <button class="tab-btn py-2 px-4 cursor-pointer" data-tab="serverSettings">
            Сам сервер
          </button>
          <button class="tab-btn py-2 px-4 cursor-pointer" data-tab="otherSettings">
            Другие
          </button>
        </div>

        <div class="tab-content">
          <!-- Основные настройки -->
          <div id="mainSettings" class="active space-y-4">
            <label class="flex items-center gap-3">
              <input type="checkbox" id="siteStatusToggle" />
              <span class="font-semibold text-gray-700">Сайт закрыт (технические работы)</span>
            </label>
            <label class="block">
              <span class="text-gray-700 font-semibold mb-1 block">Комментарий администратора</span>
              <textarea
                id="adminComment"
                rows="3"
                class="w-full p-2 border rounded"
                placeholder="Напишите комментарий для пользователей..."
              ></textarea>
            </label>
          </div>

          <!-- Онлайн -->
          <div id="onlineStatus" class="space-y-4">
            <p>Здесь будут статусы онлайн серверов (пока пусто)</p>
          </div>

          <!-- Сам сервер -->
          <div id="serverSettings" class="space-y-4">
            <p>Настройки сервера (пока пусто)</p>
          </div>

          <!-- Другие -->
          <div id="otherSettings" class="space-y-4">
            <p>Другие настройки (пока пусто)</p>
          </div>
        </div>

        <div class="flex justify-between mt-6">
          <button
            id="resetSettingsBtn"
            class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded flex items-center gap-2"
          >
            <i class="fas fa-trash"></i> Сбросить настройки
          </button>
          <button
            id="saveSettingsBtn"
            class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded flex items-center gap-2"
          >
            <i class="fas fa-save"></i> Сохранить настройки
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Оверлей закрытия сайта -->
  <div
    id="siteClosedOverlay"
    class="fixed inset-0 bg-white bg-opacity-95 flex flex-col items-center justify-center text-center p-4 hidden z-40"
  >
    <i class="fas fa-tools fa-6x text-indigo-600 mb-6 animate-bounce"></i>
    <h1 class="text-4xl font-bold mb-2 text-indigo-700">Сайт закрыт на технические работы</h1>
    <p id="overlayComment" class="mb-6 text-gray-700 max-w-md"></p>
    <button
      id="overlayOpenBtn"
      class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded shadow"
    >
      Открыть сайт (админ)
    </button>
  </div>

  <script>
    const ADMIN_CODE = "1234";

    const adminOpenBtn = document.getElementById("adminOpenBtn");
    const adminModal = document.getElementById("adminModal");
    const adminCloseBtn = document.getElementById("adminCloseBtn");
    const adminLoginSection = document.getElementById("adminLoginSection");
    const adminPanel = document.getElementById("adminPanel");
    const adminLoginBtn = document.getElementById("adminLoginBtn");
    const adminCodeInput = document.getElementById("adminCodeInput");
    const loginError = document.getElementById("loginError");

    const siteStatusToggle = document.getElementById("siteStatusToggle");
    const adminComment = document.getElementById("adminComment");
    const saveSettingsBtn = document.getElementById("saveSettingsBtn");
    const resetSettingsBtn = document.getElementById("resetSettingsBtn");

    const lastUpdateText = document.getElementById("lastUpdateText");
    const adminCommentText = document.getElementById("adminCommentText");

    const siteClosedOverlay = document.getElementById("siteClosedOverlay");
    const overlayComment = document.getElementById("overlayComment");
    const overlayOpenBtn = document.getElementById("overlayOpenBtn");

    const tabButtons = document.querySelectorAll(".tab-btn");
    const tabContents = document.querySelectorAll(".tab-content > div");

    function openModal() {
      adminModal.classList.remove("hidden");
      adminCodeInput.value = "";
      loginError.classList.add("hidden");
      adminLoginSection.style.display = "block";
      adminPanel.style.display = "none";
    }

    function closeModal() {
      adminModal.classList.add("hidden");
    }

    // Переключение табов
    tabButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        tabButtons.forEach((b) => b.classList.remove("active"));
        tabContents.forEach((c) => c.classList.remove("active"));
        btn.classList.add("active");
        document.getElementById(btn.dataset.tab).classList.add("active");
      });
    });

    function updateUI() {
      const siteStatus = localStorage.getItem("siteStatus") || "open";
      const lastUpdate = localStorage.getItem("lastUpdate");
      const comment = localStorage.getItem("adminComment") || "";

      siteStatusToggle.checked = siteStatus === "closed";
      adminComment.value = comment;
      lastUpdateText.textContent = lastUpdate || "-";
      adminCommentText.textContent = comment || "-";

      // Показываем или скрываем оверлей закрытия
      if (siteStatus === "closed") {
        siteClosedOverlay.style.display = "flex";
        overlayComment.textContent = comment;
      } else {
        siteClosedOverlay.style.display = "none";
      }
    }

    adminOpenBtn.addEventListener("click", openModal);
    adminCloseBtn.addEventListener("click", closeModal);

    adminLoginBtn.addEventListener("click", () => {
      const code = adminCodeInput.value.trim();
      if (code === ADMIN_CODE) {
        // Открываем админку
        adminLoginSection.style.display = "none";
        adminPanel.style.display = "block";
        loginError.classList.add("hidden");
      } else {
        loginError.classList.remove("hidden");
      }
    });

    saveSettingsBtn.addEventListener("click", () => {
      const code = adminCodeInput.value.trim();
      if (code !== ADMIN_CODE) {
        alert("Неверный код доступа!");
        return;
      }
      const newStatus = siteStatusToggle.checked ? "closed" : "open";
      localStorage.setItem("siteStatus", newStatus);

      const now = new Date();
      const dateString = now.toLocaleString("ru-RU", {
        dateStyle: "short",
        timeStyle: "short",
      });
      localStorage.setItem("lastUpdate", dateString);

      const commentText = adminComment.value.trim();
      localStorage.setItem("adminComment", commentText);

      updateUI();
      alert("Настройки сохранены!");
      closeModal();
    });

    resetSettingsBtn.addEventListener("click", () => {
      const code = adminCodeInput.value.trim();
      if (code !== ADMIN_CODE) {
        alert("Неверный код доступа!");
        return;
      }
      if (
        confirm(
          "Вы действительно хотите сбросить все настройки к значениям по умолчанию?"
        )
      ) {
        localStorage.removeItem("siteStatus");
        localStorage.removeItem("lastUpdate");
        localStorage.removeItem("adminComment");
        updateUI();
        alert("Настройки сброшены!");
        closeModal();
      }
    });

    // Кнопка открытия сайта поверх оверлея (при закрытом сайте)
    overlayOpenBtn.addEventListener("click", () => {
      const pass = prompt("Введите код администратора для открытия сайта:");
      if (pass === ADMIN_CODE) {
        localStorage.setItem("siteStatus", "open");
        const now = new Date();
        localStorage.setItem(
          "lastUpdate",
          now.toLocaleString("ru-RU", {
            dateStyle: "short",
            timeStyle: "short",
          })
        );
        updateUI();
        alert("Сайт открыт!");
      } else {
        alert("Неверный код!");
      }
    });

    // Инициализация
    updateUI();
  </script>
</body>
</html>
